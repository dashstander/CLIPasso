# Configuration for Cog ⚙️
# Reference: https://github.com/replicate/cog/blob/main/docs/yaml.md

build:
    # set to true if your model requires a GPU
    gpu: true

    # cuda: "11.1"
    system_packages:
        - "libgl1-mesa-glx"
        - "libglib2.0-0"
    # python version in the form '3.8' or '3.8.12'
    python_version: "3.8"

    # a list of packages in the format <package-name>==<version>
    python_packages:
        - "cmake==3.21.2"
        - "ftfy==6.0.3"
        - "cssutils==2.3.0"
        - "gdown==4.2.0"
        - "imageio==2.9.0"
        - "imageio-ffmpeg==0.4.4"
        - "importlib-metadata==4.6.4"
        - "ipykernel==6.1.0"
        - "ipython==7.26.0"
        - "ipython-genutils==0.2.0"
        - "json5==0.9.5"
        - "jsonpatch==1.32"
        - "jsonpointer==2.1"
        - "jsonschema==3.2.0"
        - "jupyter-client==6.1.12"
        - "jupyter-core==4.7.1"
        - "jupyter-server==1.10.2"
        - "jupyterlab==3.1.6"
        - "jupyterlab-pygments==0.1.2"
        - "jupyterlab-server==2.7.0"
        - "matplotlib==3.4.2"
        - "matplotlib-inline==0.1.2"
        - "moviepy==1.0.3"
        - "notebook==6.4.3"
        - "numba==0.53.1"
        - "numpy==1.20.3"
        - "nvidia-ml-py3==7.352.0"
        - "opencv-python==4.5.3.56"
        - "pandas==1.3.2"
        - "pathtools==0.1.2"
        - "Pillow==8.2.0"
        - "pip==21.2.2"
        - "plotly==5.2.1"
        - "psutil==5.8.0"
        - "ptyprocess==0.7.0"
        - "pyaml==21.8.3"
        - "regex==2021.11.10"
        - "scikit-image==0.18.1"
        - "scikit-learn==1.0.2"
        - "scipy==1.6.2"
        - "seaborn==0.11.2"
        - "subprocess32==3.5.4"
        - "svgpathtools==1.4.1"
        - "svgwrite==1.4.1"
        - "torch-tools==0.1.5"
        - "torchfile==0.1.0"
        - "torch==1.7.1"
        - "torchvision==0.8.2"
        - "tqdm==4.62.1"
        - "visdom==0.1.8.9"
        - "wandb==0.12.0"
        - "webencodings==0.5.1"
        - "websocket-client==0.57.0"
        - "zipp==3.5.0"
    
    run:
        - "git clone https://github.com/BachiLi/diffvg && cd diffvg && git submodule update --init --recursive && CMAKE_PREFIX_PATH=$(pyenv prefix) DIFFVG_CUDA=1 python setup.py install"
        - "pip install git+https://github.com/openai/CLIP.git@main#egg=clip"
        - "python -c 'import torchvision; torchvision.models.vgg16(pretrained=True)'"
        - python -c 'import clip; [clip.load(model) for model in ("RN50", "RN101", "RN50x4", "RN50x16", "ViT-B/32", "ViT-B/16",)]'
# predict.py defines how predictions are run on your model
predict: "cog_sketch.py:Predictor"
